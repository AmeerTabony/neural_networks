

FOLDS = 10;
path = '/Users/hilldi/Documents/MATLAB/Neuro computations/hw1';
% diary(strcat(path,'/myTextLog6.txt'));
%% get wine data
shuffledWines = getShuffledWines();
%%
avgSR = 0;
tic

avgSR = 0;
for fold=1:1
%     diary(strcat(path,'/myTextLog4.txt'));
    tic
    
    [train,test] = splitData(shuffledWines,FOLDS,1);
    trainingData = 
    train(:,2:end) = normr(train(:,2:end)); 
    test(:,2:end) = normr(test(:,2:end));

    trainOutput = formatOutput(train(:,1));
    ouputSize = size(trainOutput,2);

    layerSizes = [12,ouputSize]; % assuming only 7 classes, unsure*

    trainingOpts.learningRate = 0.9;
    trainingOpts.numOfEpochs = 40;
    trainingOpts.learningDecreaseRate = 0.9;
    trainingOpts.learningDropRate = 4;

    network = trainNetwork( train(:,1:end-1), trainOutput, layerSizes, trainingOpts );
    toc

    testOutput = formatOutput(test(:,end));
    sr = testNetwork(network, test(:,1:end-1), testOutput) ;

    logstr = strcat('Fold num: ',num2str(fold),' success rate: ',num2str(sr),'%%');
    sprintf(logstr)

    avgSR = avgSR + sr;
%     diary('off');
end
%logstr = strcat('END of all validations. average success rate: ',num2str(avgSR/FOLDS),'%%');
% sprintf(logstr)
                   
toc

% diary('off');